<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>支票金額轉換器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        input, button {
            margin: 10px 0;
            padding: 5px;
        }
        #result {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>支票金額轉換器</h1>
        <label for="amount">輸入金額：</label>
        <input type="number" id="amount" placeholder="輸入金額" step="0.01">
        <button onclick="convertAmount()">轉換</button>
        <div id="result" aria-live="polite"></div>
    </div>

    <script>
        const digits = Object.freeze(['零', '壹', '貳', '參', '肆', '伍', '陸', '柒', '捌', '玖']);
        const units = Object.freeze(['', '萬', '億', '兆']);
        const positions = Object.freeze(['', '拾', '佰', '仟']);

        const convertAmount = () => {
            const amount = parseFloat(document.getElementById('amount')?.value ?? '0');
            if (isNaN(amount) || amount < 0 || amount > 999999999999.99) {
                alert('請輸入有效的金額（0-999,999,999,999.99）');
                return;
            }

            const [chineseResult, englishResult] = [numberToChineseWords, numberToEnglishWords]
                .map(converter => converter(amount));

            document.getElementById('result').innerHTML = `
                <p>中文大寫：${chineseResult}</p>
                <p>英文大寫：${englishResult}</p>
            `;
        };

        const numberToChineseWords = (num) => {
            const [integer, decimal] = [Math.floor(num), Math.round((num % 1) * 100)];

            if (integer === 0 && decimal === 0) return '零元整';

            const processInteger = (int) => {
                if (int === 0) return '零';
                if (int < 10) return digits[int];
                
                let result = '';
                let unitIndex = 0;
                let hasZero = false;

                while (int > 0) {
                    const section = int % 10000;
                    let sectionStr = '';

                    for (let i = 0; i < 4; i++) {
                        const digit = Math.floor(section / Math.pow(10, i)) % 10;
                        if (digit !== 0) {
                            if (hasZero) {
                                sectionStr = '零' + sectionStr;
                                hasZero = false;
                            }
                            sectionStr = digits[digit] + positions[i] + sectionStr;
                        } else if (sectionStr !== '') {
                            hasZero = true;
                        }
                    }

                    if (sectionStr !== '') {
                        result = sectionStr + (unitIndex > 0 ? units[unitIndex] : '') + result;
                        hasZero = false;
                    }

                    int = Math.floor(int / 10000);
                    unitIndex++;
                }

                return result;
            };

            const integerPart = integer > 0 ? `${processInteger(integer)}元` : '';
            const decimalPart = decimal > 0
                ? `${integerPart || '零元'}${Math.floor(decimal / 10) > 0 ? `${digits[Math.floor(decimal / 10)]}角` : ''}${decimal % 10 > 0 ? `${digits[decimal % 10]}分` : ''}`
                : `${integerPart}整`;

            return decimalPart || '零元整';
        };

        const numberToEnglishWords = (() => {
            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
            const tens = ['', 'Ten', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            const teens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];

            const convertLessThanOneThousand = (n) => {
                if (n === 0) return '';
                if (n < 10) return ones[n];
                if (n < 20) return teens[n - 10];
                if (n < 100) {
                    const ten = Math.floor(n / 10);
                    const one = n % 10;
                    return `${tens[ten]}${one ? '-' + ones[one] : ''}`;
                }
                const hundred = Math.floor(n / 100);
                const remainder = n % 100;
                return `${ones[hundred]} Hundred${remainder ? ' ' + convertLessThanOneThousand(remainder) : ''}`;
            };

            return (num) => {
                const [integer, decimal] = [Math.floor(num), Math.round((num % 1) * 100)];

                if (integer === 0 && decimal === 0) return 'Zero Dollar';

                const processInteger = (int) => {
                    if (int === 0) return '';
                    if (int < 1000) return convertLessThanOneThousand(int);

                    const sections = [
                        { value: Math.floor(int / 1e9), name: 'Billion' },
                        { value: Math.floor((int % 1e9) / 1e6), name: 'Million' },
                        { value: Math.floor((int % 1e6) / 1e3), name: 'Thousand' },
                        { value: int % 1e3, name: '' }
                    ];

                    return sections
                        .filter(section => section.value > 0)
                        .map(section => `${convertLessThanOneThousand(section.value)} ${section.name}`)
                        .join(' ');
                };

                const integerPart = integer > 0 ? `${processInteger(integer)} Dollar${integer === 1 ? '' : 's'}` : '';
                const decimalPart = decimal > 0
                    ? `${decimal < 10 ? `${ones[decimal]} Cent${decimal === 1 ? '' : 's'}` :
                        decimal < 20 ? `${teens[decimal - 10]} Cents` :
                        `${tens[Math.floor(decimal / 10)]}${decimal % 10 ? '-' + ones[decimal % 10] : ''} Cents`}`
                    : '';

                if (integerPart && decimalPart) {
                    return `${integerPart} and ${decimalPart}`;
                } else if (integerPart) {
                    return integerPart;
                } else if (decimalPart) {
                    return `Zero Dollar and ${decimalPart}`;
                } else {
                    return 'Zero Dollar';
                }
            };
        })();

        document.getElementById('amount').addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                convertAmount();
            }
        });
    </script>
</body>
</html>
